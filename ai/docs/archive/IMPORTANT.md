# 重要な開発方針

## ⚡ スピード最優先

**原則**: 全ての計算処理はBigQueryで完結させる

### 理由
- ローカルPythonでのループ処理は遅すぎる（26万行で20-40分）
- バッファリング問題で進捗が見えない
- 開発のスピード感が失われる
- セッション切れ後も動作が不確実

### 実装方針

✅ **DO（推奨）**:
1. BigQueryで全ての特徴量計算を完結
2. Window関数・JOIN・集約を活用
3. 結果をGCSにエクスポート
4. ローカルはダウンロードと簡単な分割のみ

❌ **DON'T（避ける）**:
1. ローカルPythonでの大規模ループ処理
2. ローカルでの複雑な計算
3. バックグラウンドタスクでの長時間実行

### 適用例

**タイム偏差値の計算**:
- ❌ Pythonで26万行ループ → 30分
- ✅ BigQueryで一発計算 → 2-3分

**特徴量エンジニアリング**:
- ❌ Pythonで逐次処理 → 数十分
- ✅ BigQueryでWindow関数 → 数分

## 📝 今後の開発で意識すること

1. **データ処理は全てBigQuery**
2. **ローカルは軽い処理のみ**
3. **進捗が見える方法を選択**
4. **完了が確実な方法を選択**

---

**最終更新**: 2025年12月26日
**重要度**: 🔴 最高
